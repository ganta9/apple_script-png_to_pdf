# PNG to PDF 変換ツール

macOS用のPNG画像をPDFに一括変換するAppleScriptツールです。v4.0では**完全な横向きPDF対応**を実現し、200MB自動分割機能と実行時ページ設定機能を搭載しています。

## 📁 プロジェクト構造

```
PNG_to_PDF/
├── README.md                    # このファイル
├── CLAUDE.md                    # Claude Code用プロジェクト情報
├── versions/                    # バージョン管理フォルダ
│   ├── v1.0_basic/             # v1.0 基本版
│   │   ├── main.scpt           # 実行ファイル
│   │   ├── main.applescript    # ソースコード
│   │   └── VERSION_INFO.md     # バージョン詳細
│   ├── v2.0_split_feature/     # v2.0 分割機能版
│   └── v4.0_page_settings/     # v4.0 ページ設定・横向き対応版 ⭐ 推奨
│       ├── main.scpt           # 実行ファイル（200MB分割対応）
│       ├── main.applescript    # ソースコード
│       └── VERSION_INFO.md     # バージョン詳細
├── docs/                       # ドキュメント
│   ├── PNG_to_PDF_仕様書.md    # 統合仕様書
│   ├── 200MB分割機能_説明書.md  # v2.0新機能詳細
│   └── ImageMagickによる横向きPDF実装_完全ガイド.md  # 横向きPDF技術解説
└── temp/                       # 一時ファイル用（作業時のみ）
```

## 🚀 クイックスタート

### 最新版（v4.0）の使用方法

1. **前提条件の確認**
   ```bash
   # ImageMagickのインストール
   brew install imagemagick
   ```

2. **スクリプトの実行**
   ```bash
   # v4.0（横向きPDF・ページ設定対応版）を実行
   osascript versions/v4.0_page_settings/main.scpt
   ```

3. **ダイアログに従って操作**
   - PDFファイル名を入力
   - ページサイズを選択（A4/A3）
   - 向きを選択（縦/横）
   - 変換設定を確認
   - 完了後、PNG削除の可否を選択

## 📋 バージョン比較

| 機能 | v1.0 基本版 | v2.0 分割版 | v4.0 ページ設定版 |
|------|-------------|-------------|-------------------|
| PNG→PDF変換 | ✅ | ✅ | ✅ |
| 一括処理 | ✅ | ✅ | ✅ |
| GUI操作 | ✅ | ✅ | ✅ |
| ファイルサイズ制限 | ❌ | ✅ 200MB | ✅ 200MB |
| 自動分割 | ❌ | ✅ | ✅ |
| 進捗表示 | ❌ | ✅ | ✅ |
| ページサイズ選択 | ❌ | ❌ | ✅ A4/A3 |
| 横向きPDF対応 | ❌ | ❌ | ✅ 完全対応 |
| エラーハンドリング | 基本 | 強化 | 強化 |

## 🔧 設定

### 共通設定（全バージョン）
- **ソースフォルダ**: `/Users/gantaku/本/_screenshot/`
- **保存フォルダ**: `/Users/gantaku/本/`
- **画像品質**: 85%
- **最大ファイルサイズ**: 200MB（v2.0以降）
- **分割命名形式**: `filename_part1.pdf`, `filename_part2.pdf`（v2.0以降）

### v4.0新機能設定
- **ページサイズ**: A4（210×297mm）、A3（297×420mm）から実行時選択
- **向き**: 縦（Portrait）、横（Landscape）から実行時選択
- **横向きPDF技術**: ImageMagickオフセット付きページサイズ指定（`-page 842x595+0+0`）

## 📖 詳細ドキュメント

### 📚 完全な仕様書
[`docs/PNG_to_PDF_仕様書.md`](docs/PNG_to_PDF_仕様書.md) - 全機能の詳細仕様

### 🆕 v2.0新機能解説
[`docs/200MB分割機能_説明書.md`](docs/200MB分割機能_説明書.md) - 分割機能の技術詳細

### 🎯 v4.0横向きPDF技術解説
[`docs/ImageMagickによる横向きPDF実装_完全ガイド.md`](docs/ImageMagickによる横向きPDF実装_完全ガイド.md) - 横向きPDF実装の完全技術資料

### 🔍 バージョン詳細
- [`versions/v1.0_basic/VERSION_INFO.md`](versions/v1.0_basic/VERSION_INFO.md) - v1.0詳細
- [`versions/v2.0_split_feature/VERSION_INFO.md`](versions/v2.0_split_feature/VERSION_INFO.md) - v2.0詳細
- [`versions/v4.0_page_settings/VERSION_INFO.md`](versions/v4.0_page_settings/VERSION_INFO.md) - v4.0詳細

## 💡 使用例

### 基本的な使用（v4.0推奨）
```bash
# 最新版の実行（横向きPDF対応）
osascript versions/v4.0_page_settings/main.scpt
```

### 旧バージョンの使用（互換性確認時など）
```bash
# v2.0の実行（分割機能のみ）
osascript versions/v2.0_split_feature/main.scpt

# v1.0の実行（基本機能のみ）
osascript versions/v1.0_basic/main.scpt
```

## 🔄 最新版（v4.0）への移行

### 互換性
- **完全下位互換**: v1.0/v2.0と同じ操作で使用可能
- **設定継承**: 既存設定はそのまま使用
- **小規模処理**: 旧バージョンと同等の動作
- **新機能**: ページサイズ・向き選択は任意で使用可能

### 新機能の恩恵
- **横向きPDF**: 完全な横向きページレイアウト（プレゼン資料等に最適）
- **柔軟なページ設定**: A4/A3サイズの実行時選択
- **大量画像処理**: 安定性向上（v2.0継承）
- **メール添付対応**: 25MB制限への自動分割（v2.0継承）
- **技術的知見**: 横向きPDF実装の完全解決（失敗事例も含む技術資料を提供）

## ⚠️ 重要な注意点

### システム要件
- **OS**: macOS（AppleScript対応）
- **依存ソフト**: ImageMagick（Homebrew推奨）
- **権限**: ファイルアクセス権限

### 制限事項
- **単一ファイル制限**: 1つのPNGで200MB超過の場合は分割不可
- **パス固定**: ソース・保存フォルダはスクリプト内で固定
- **macOS専用**: 他OSでは動作不可

## 🔮 今後の開発予定

- [x] 横向きPDF完全対応（v4.0で実現）
- [x] 実行時ページサイズ選択（v4.0で実現）
- [ ] 設定ファイル対応（パス設定の外部化）
- [ ] 分割サイズのカスタマイズ機能
- [ ] プログレスバー改善
- [ ] ドラッグ&ドロップ対応
- [ ] 多言語対応

## 📞 サポート

### トラブルシューティング
1. **ImageMagick未検出**: `brew install imagemagick`で再インストール
2. **フォルダ不存在**: 指定パスの確認と作成
3. **権限エラー**: macOSのプライバシー設定を確認

### 設定変更
スクリプト内の設定値を直接編集することで、フォルダパスや分割サイズを変更可能です。

## 🎉 v4.0の主要成果

### 横向きPDF実装の技術的ブレークスルー
v4.0では、8つの失敗アプローチを経て、ImageMagickによる完全な横向きPDF作成を実現しました：

- **成功の鍵**: オフセット付きページサイズ指定（`-page 842x595+0+0`）
- **実現内容**: PDFビューアで真の横向きページ表示
- **技術資料**: 全失敗事例と成功パターンを完全記録

---

**推奨**: 最新の安定版として **v4.0 ページ設定・横向き対応版** の使用を推奨します。